# AI Sales Buddy
## Data Flow Architecture

**Prepared for:** Hyundai Motor India  
**Prepared by:** Maigic.AI  
**Version:** 1.0 | December 2025

---

<br/>

## 1. High-Level Data Flow

<br/>

```
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                                                                                         │
│                           END-TO-END DATA FLOW                                          │
│                                                                                         │
│                                                                                         │
│   ┌──────────────┐                                                                     │
│   │              │                                                                     │
│   │    Sales     │  Query (Text/Voice)                                                 │
│   │  Consultant  │─────────────────────────┐                                           │
│   │              │                         │                                           │
│   └──────────────┘                         ▼                                           │
│                                  ┌───────────────────┐                                 │
│                                  │                   │                                 │
│                                  │   WIDGET (UI)     │                                 │
│                                  │                   │                                 │
│                                  │   LMS / H-Smart   │                                 │
│                                  │                   │                                 │
│                                  └─────────┬─────────┘                                 │
│                                            │                                           │
│                                            │ SSO Token + Query                         │
│                                            ▼                                           │
│                                  ┌───────────────────┐                                 │
│                                  │                   │                                 │
│                                  │   API GATEWAY     │                                 │
│                                  │                   │                                 │
│                                  │   Auth + Route    │                                 │
│                                  │                   │                                 │
│                                  └─────────┬─────────┘                                 │
│                                            │                                           │
│                                            │ Validated Request                         │
│                                            ▼                                           │
│                                  ┌───────────────────┐                                 │
│                                  │                   │                                 │
│                                  │   ORCHESTRATOR    │◄──────┐                         │
│                                  │                   │       │                         │
│                                  │   Intent + Route  │       │ Context                 │
│                                  │                   │       │                         │
│                                  └─────────┬─────────┘       │                         │
│                                            │                 │                         │
│               ┌────────────────────────────┼─────────────────┴───────────┐             │
│               │                            │                             │             │
│               ▼                            ▼                             ▼             │
│     ┌─────────────────┐          ┌─────────────────┐          ┌─────────────────┐     │
│     │                 │          │                 │          │                 │     │
│     │   LMS DATA      │          │   WEB SEARCH    │          │   RAG (Docs)    │     │
│     │                 │          │                 │          │                 │     │
│     │   Products      │          │   Competitors   │          │   Training      │     │
│     │   Pricing       │          │   Market Intel  │          │   Policies      │     │
│     │                 │          │                 │          │                 │     │
│     └────────┬────────┘          └────────┬────────┘          └────────┬────────┘     │
│              │                            │                            │              │
│              └────────────────────────────┼────────────────────────────┘              │
│                                           │                                            │
│                                           │ Merged Context                             │
│                                           ▼                                            │
│                                  ┌───────────────────┐                                 │
│                                  │                   │                                 │
│                                  │   LLM ENGINE      │                                 │
│                                  │                   │                                 │
│                                  │   Generate        │                                 │
│                                  │   Response        │                                 │
│                                  │                   │                                 │
│                                  └─────────┬─────────┘                                 │
│                                            │                                           │
│                                            │ Response                                  │
│                                            ▼                                           │
│                                  ┌───────────────────┐                                 │
│                                  │                   │                                 │
│                                  │   OUTPUT LAYER    │                                 │
│                                  │                   │                                 │
│                                  │   Text + Voice    │                                 │
│                                  │   + Avatar        │                                 │
│                                  │                   │                                 │
│                                  └─────────┬─────────┘                                 │
│                                            │                                           │
│                                            ▼                                           │
│   ┌──────────────┐               Response (Text/Voice/Avatar)                         │
│   │              │◄────────────────────────────────────────────                        │
│   │    Sales     │                                                                     │
│   │  Consultant  │                                                                     │
│   │              │                                                                     │
│   └──────────────┘                                                                     │
│                                                                                         │
└─────────────────────────────────────────────────────────────────────────────────────────┘
```

<br/>

---

<br/>

## 2. Query Processing Pipeline

Step-by-step breakdown of how a query is processed:

<br/>

```
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                                                                                         │
│                           QUERY PROCESSING PIPELINE                                     │
│                                                                                         │
│                                                                                         │
│   ┌─────────────────────────────────────────────────────────────────────────────────┐  │
│   │  STAGE 1: INPUT PROCESSING                                                      │  │
│   │                                                                                 │  │
│   │                                                                                 │  │
│   │    User Input                 Processing                     Output            │  │
│   │    ──────────                 ──────────                     ──────            │  │
│   │                                                                                 │  │
│   │    🎤 Voice ──────────► Speech-to-Text ──────────► Raw Text                    │  │
│   │                              │                                                  │  │
│   │    ⌨️ Text ───────────────────┼──────────────────────┐                          │  │
│   │                              │                       │                          │  │
│   │                              ▼                       ▼                          │  │
│   │                     Language Detection          Sanitize                        │  │
│   │                              │                       │                          │  │
│   │                              └───────────┬───────────┘                          │  │
│   │                                          ▼                                      │  │
│   │                                   Normalized Query                              │  │
│   │                                   + Detected Language                           │  │
│   │                                                                                 │  │
│   └─────────────────────────────────────────────────────────────────────────────────┘  │
│                                          │                                             │
│                                          ▼                                             │
│   ┌─────────────────────────────────────────────────────────────────────────────────┐  │
│   │  STAGE 2: INTENT CLASSIFICATION                                                 │  │
│   │                                                                                 │  │
│   │                                                                                 │  │
│   │    Query: "Compare Creta with Seltos in Hindi"                                  │  │
│   │                              │                                                  │  │
│   │                              ▼                                                  │  │
│   │                    ┌─────────────────────┐                                      │  │
│   │                    │   Intent Classifier │                                      │  │
│   │                    └─────────────────────┘                                      │  │
│   │                              │                                                  │  │
│   │                              ▼                                                  │  │
│   │    ┌─────────────────────────────────────────────────────────────────────┐     │  │
│   │    │                                                                     │     │  │
│   │    │   Intent:     COMPETITOR_COMPARISON                                │     │  │
│   │    │   Entities:   hyundai_model = "Creta"                              │     │  │
│   │    │               competitor_model = "Seltos"                          │     │  │
│   │    │   Language:   Hindi                                                 │     │  │
│   │    │   Confidence: 0.94                                                  │     │  │
│   │    │                                                                     │     │  │
│   │    └─────────────────────────────────────────────────────────────────────┘     │  │
│   │                                                                                 │  │
│   └─────────────────────────────────────────────────────────────────────────────────┘  │
│                                          │                                             │
│                                          ▼                                             │
│   ┌─────────────────────────────────────────────────────────────────────────────────┐  │
│   │  STAGE 3: AGENT ROUTING                                                         │  │
│   │                                                                                 │  │
│   │                                                                                 │  │
│   │    ┌──────────────────────────────────────────────────────────────────────┐    │  │
│   │    │                         ORCHESTRATOR                                  │    │  │
│   │    │                                                                       │    │  │
│   │    │   Intent → Agent Mapping                                              │    │  │
│   │    │                                                                       │    │  │
│   │    │   PRODUCT_INFO       ──────►  Knowledge Agent                        │    │  │
│   │    │   COMPETITOR_COMPARE ──────►  Comparison Agent  ✓                    │    │  │
│   │    │   SALES_PROCESS      ──────►  Coaching Agent                         │    │  │
│   │    │   TRAINING           ──────►  Knowledge Agent                        │    │  │
│   │    │   PRICING            ──────►  Knowledge Agent (Real-time)            │    │  │
│   │    │                                                                       │    │  │
│   │    └──────────────────────────────────────────────────────────────────────┘    │  │
│   │                                                                                 │  │
│   └─────────────────────────────────────────────────────────────────────────────────┘  │
│                                          │                                             │
│                                          ▼                                             │
│   ┌─────────────────────────────────────────────────────────────────────────────────┐  │
│   │  STAGE 4: DATA RETRIEVAL (Parallel)                                             │  │
│   │                                                                                 │  │
│   │                                                                                 │  │
│   │       ┌─────────────────────┐              ┌─────────────────────┐             │  │
│   │       │                     │              │                     │             │  │
│   │       │   LMS CONNECTOR     │              │   WEB CONNECTOR     │             │  │
│   │       │                     │              │                     │             │  │
│   │       │   ▼ Cache Check     │              │   ▼ Cache Check     │             │  │
│   │       │   ▼ API Call        │              │   ▼ Search API      │             │  │
│   │       │   ▼ Validate        │              │   ▼ Extract Data    │             │  │
│   │       │                     │              │   ▼ Validate        │             │  │
│   │       │   RESULT:           │              │                     │             │  │
│   │       │   Creta specs ✓     │              │   RESULT:           │             │  │
│   │       │   Creta price ✓     │              │   Seltos specs ✓    │             │  │
│   │       │   Creta features ✓  │              │   Seltos price ✓    │             │  │
│   │       │                     │              │                     │             │  │
│   │       └──────────┬──────────┘              └──────────┬──────────┘             │  │
│   │                  │                                    │                        │  │
│   │                  └────────────────┬───────────────────┘                        │  │
│   │                                   ▼                                            │  │
│   │                          ┌────────────────┐                                    │  │
│   │                          │  DATA MERGER   │                                    │  │
│   │                          │                │                                    │  │
│   │                          │  Normalize     │                                    │  │
│   │                          │  Validate      │                                    │  │
│   │                          │  Structure     │                                    │  │
│   │                          └────────────────┘                                    │  │
│   │                                                                                 │  │
│   └─────────────────────────────────────────────────────────────────────────────────┘  │
│                                          │                                             │
│                                          ▼                                             │
│   ┌─────────────────────────────────────────────────────────────────────────────────┐  │
│   │  STAGE 5: RESPONSE GENERATION                                                   │  │
│   │                                                                                 │  │
│   │                                                                                 │  │
│   │    ┌─────────────────────────────────────────────────────────────────────┐     │  │
│   │    │                           LLM ENGINE                                 │     │  │
│   │    │                                                                     │     │  │
│   │    │   Input:                                                            │     │  │
│   │    │   ├── System Prompt: "You are Hyundai Sales Expert..."              │     │  │
│   │    │   ├── Context: Merged Creta + Seltos data                           │     │  │
│   │    │   └── Instruction: Generate comparison, highlight Hyundai USPs      │     │  │
│   │    │                                                                     │     │  │
│   │    │   Output:                                                           │     │  │
│   │    │   ├── Comparison table                                              │     │  │
│   │    │   ├── Summary text                                                  │     │  │
│   │    │   └── Key selling points                                            │     │  │
│   │    │                                                                     │     │  │
│   │    └─────────────────────────────────────────────────────────────────────┘     │  │
│   │                                                                                 │  │
│   └─────────────────────────────────────────────────────────────────────────────────┘  │
│                                          │                                             │
│                                          ▼                                             │
│   ┌─────────────────────────────────────────────────────────────────────────────────┐  │
│   │  STAGE 6: OUTPUT FORMATTING                                                     │  │
│   │                                                                                 │  │
│   │                                                                                 │  │
│   │    Response (English)                                                           │  │
│   │           │                                                                     │  │
│   │           ├────────────► Translate to Hindi ────────► Hindi Text               │  │
│   │           │                                                  │                  │  │
│   │           │                                                  ▼                  │  │
│   │           │                                          Text-to-Speech             │  │
│   │           │                                                  │                  │  │
│   │           │                                                  ▼                  │  │
│   │           │                                          Hindi Audio               │  │
│   │           │                                                                     │  │
│   │           └────────────► Format Table ──────────────► Rich Response            │  │
│   │                                                                                 │  │
│   │                                                                                 │  │
│   │    FINAL OUTPUT:                                                                │  │
│   │    ┌─────────────────────────────────────────────────────────────────────┐     │  │
│   │    │  📝 Text (Hindi) + 🔊 Audio (Hindi) + 📊 Table + 👤 Avatar          │     │  │
│   │    └─────────────────────────────────────────────────────────────────────┘     │  │
│   │                                                                                 │  │
│   └─────────────────────────────────────────────────────────────────────────────────┘  │
│                                                                                         │
└─────────────────────────────────────────────────────────────────────────────────────────┘
```

<br/>

---

<br/>

## 3. Data Source Integration

How different data sources feed into the system:

<br/>

```
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                                                                                         │
│                           DATA SOURCE INTEGRATION                                       │
│                                                                                         │
│                                                                                         │
│   ┌───────────────────────────────────────────────────────────────────────────────┐    │
│   │                                                                               │    │
│   │                           HYUNDAI SYSTEMS                                     │    │
│   │                                                                               │    │
│   │   ┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐   │    │
│   │   │             │    │             │    │             │    │             │   │    │
│   │   │  LMS APIs   │    │  HRMS       │    │  CMS        │    │  SSO/IdP    │   │    │
│   │   │             │    │             │    │             │    │             │   │    │
│   │   │  Products   │    │  Users      │    │  Content    │    │  Auth       │   │    │
│   │   │  Training   │    │  Roles      │    │  Updates    │    │  Tokens     │   │    │
│   │   │  Pricing    │    │  Dealers    │    │             │    │             │   │    │
│   │   │             │    │             │    │             │    │             │   │    │
│   │   └──────┬──────┘    └──────┬──────┘    └──────┬──────┘    └──────┬──────┘   │    │
│   │          │                  │                  │                  │          │    │
│   └──────────┼──────────────────┼──────────────────┼──────────────────┼──────────┘    │
│              │                  │                  │                  │               │
│              │ REST API         │ Webhook          │ Webhook          │ OAuth 2.0     │
│              │                  │                  │                  │               │
│              ▼                  ▼                  ▼                  ▼               │
│   ┌───────────────────────────────────────────────────────────────────────────────┐   │
│   │                                                                               │   │
│   │                        AI SALES BUDDY CONNECTORS                              │   │
│   │                                                                               │   │
│   │   ┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐   │   │
│   │   │             │    │             │    │             │    │             │   │   │
│   │   │  LMS        │    │  User Sync  │    │  Content    │    │  Auth       │   │   │
│   │   │  Connector  │    │  Service    │    │  Listener   │    │  Service    │   │   │
│   │   │             │    │             │    │             │    │             │   │   │
│   │   └──────┬──────┘    └──────┬──────┘    └──────┬──────┘    └──────┬──────┘   │   │
│   │          │                  │                  │                  │          │   │
│   │          ▼                  ▼                  ▼                  ▼          │   │
│   │   ┌─────────────────────────────────────────────────────────────────────┐   │   │
│   │   │                         DATA STORE                                   │   │   │
│   │   │                                                                      │   │   │
│   │   │   Vector DB       │   User Profiles   │   Session Cache             │   │   │
│   │   │   (Embeddings)    │   (MongoDB)       │   (Redis)                   │   │   │
│   │   │                                                                      │   │   │
│   │   └─────────────────────────────────────────────────────────────────────┘   │   │
│   │                                                                               │   │
│   └───────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                         │
│   ┌───────────────────────────────────────────────────────────────────────────────┐   │
│   │                                                                               │   │
│   │                           EXTERNAL SOURCES                                    │   │
│   │                                                                               │   │
│   │   ┌─────────────┐    ┌─────────────┐    ┌─────────────┐                      │   │
│   │   │             │    │             │    │             │                      │   │
│   │   │  Search API │    │  OEM Sites  │    │  News       │                      │   │
│   │   │             │    │             │    │             │                      │   │
│   │   │  Competitor │    │  Specs      │    │  Market     │                      │   │
│   │   │  Data       │    │  Pricing    │    │  Updates    │                      │   │
│   │   │             │    │             │    │             │                      │   │
│   │   └──────┬──────┘    └──────┬──────┘    └──────┬──────┘                      │   │
│   │          │                  │                  │                              │   │
│   │          └──────────────────┼──────────────────┘                              │   │
│   │                             ▼                                                 │   │
│   │                    ┌─────────────────┐                                        │   │
│   │                    │  Web Connector  │                                        │   │
│   │                    │  + Cache        │                                        │   │
│   │                    └─────────────────┘                                        │   │
│   │                                                                               │   │
│   └───────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                         │
└─────────────────────────────────────────────────────────────────────────────────────────┘
```

<br/>

---

<br/>

## 4. Multi-Agent Collaboration

How agents work together to answer complex queries:

<br/>

```
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                                                                                         │
│                           MULTI-AGENT COLLABORATION                                     │
│                                                                                         │
│                                                                                         │
│   Query: "Why should a customer buy Creta instead of Seltos? Give me sales tips."      │
│                                                                                         │
│                                           │                                             │
│                                           ▼                                             │
│                               ┌───────────────────────┐                                │
│                               │                       │                                │
│                               │     ORCHESTRATOR      │                                │
│                               │                       │                                │
│                               │   Analysis:           │                                │
│                               │   • Comparison needed │                                │
│                               │   • Coaching needed   │                                │
│                               │                       │                                │
│                               └───────────┬───────────┘                                │
│                                           │                                             │
│                        ┌──────────────────┴──────────────────┐                         │
│                        │                                     │                         │
│                        ▼                                     ▼                         │
│         ┌───────────────────────────┐         ┌───────────────────────────┐           │
│         │                           │         │                           │           │
│         │    COMPARISON AGENT       │         │    COACHING AGENT         │           │
│         │                           │         │                           │           │
│         │    Task:                  │         │    Task:                  │           │
│         │    Compare Creta vs       │         │    Provide sales tips     │           │
│         │    Seltos                 │         │    for selling Creta      │           │
│         │                           │         │                           │           │
│         │    ┌─────────────────┐    │         │    ┌─────────────────┐    │           │
│         │    │ LMS: Creta data │    │         │    │ RAG: Training   │    │           │
│         │    └─────────────────┘    │         │    │ docs on selling │    │           │
│         │    ┌─────────────────┐    │         │    └─────────────────┘    │           │
│         │    │ Web: Seltos data│    │         │                           │           │
│         │    └─────────────────┘    │         │                           │           │
│         │                           │         │                           │           │
│         │    Output:                │         │    Output:                │           │
│         │    Feature comparison     │         │    Objection handling     │           │
│         │    table with USPs        │         │    tips, key phrases      │           │
│         │                           │         │                           │           │
│         └─────────────┬─────────────┘         └─────────────┬─────────────┘           │
│                       │                                     │                         │
│                       └──────────────────┬──────────────────┘                         │
│                                          │                                             │
│                                          ▼                                             │
│                               ┌───────────────────────┐                                │
│                               │                       │                                │
│                               │   RESPONSE MERGER     │                                │
│                               │                       │                                │
│                               │   Combine outputs     │                                │
│                               │   into single         │                                │
│                               │   coherent response   │                                │
│                               │                       │                                │
│                               └───────────────────────┘                                │
│                                          │                                             │
│                                          ▼                                             │
│   ┌─────────────────────────────────────────────────────────────────────────────────┐ │
│   │                                                                                 │ │
│   │   COMBINED RESPONSE:                                                            │ │
│   │                                                                                 │ │
│   │   📊 COMPARISON TABLE                                                           │ │
│   │   ┌──────────────┬────────────┬────────────┐                                   │ │
│   │   │ Feature      │ Creta      │ Seltos     │                                   │ │
│   │   │──────────────│────────────│────────────│                                   │ │
│   │   │ ADAS         │ Level 2 ✓  │ Basic      │                                   │ │
│   │   │ Sunroof      │ Panoramic  │ Single     │                                   │ │
│   │   └──────────────┴────────────┴────────────┘                                   │ │
│   │                                                                                 │ │
│   │   🎯 SALES TIPS                                                                 │ │
│   │   • "Creta's Level 2 ADAS has 19 safety features - ask customer about..."     │ │
│   │   • "If customer mentions Seltos sunroof, highlight Panoramic difference..."   │ │
│   │   • "Focus on after-sales - Hyundai's 3350+ touchpoints vs Kia's 1000+..."    │ │
│   │                                                                                 │ │
│   └─────────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                         │
└─────────────────────────────────────────────────────────────────────────────────────────┘
```

<br/>

---

<br/>

## 5. Caching Strategy

How we optimize response times with intelligent caching:

<br/>

```
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                                                                                         │
│                           CACHING ARCHITECTURE                                          │
│                                                                                         │
│                                                                                         │
│   ┌─────────────────────────────────────────────────────────────────────────────────┐  │
│   │                              CACHE LAYERS                                        │  │
│   │                                                                                  │  │
│   │                                                                                  │  │
│   │    ┌────────────────────────────────────────────────────────────────────────┐   │  │
│   │    │                                                                        │   │  │
│   │    │   LAYER 1: HOT CACHE (Redis)                    TTL: 5 min - 1 hour   │   │  │
│   │    │                                                                        │   │  │
│   │    │   • Live pricing                                                       │   │  │
│   │    │   • Stock availability                                                 │   │  │
│   │    │   • Active session data                                                │   │  │
│   │    │   • Recent query results                                               │   │  │
│   │    │                                                                        │   │  │
│   │    │   Hit Rate Target: 70%+                                                │   │  │
│   │    │                                                                        │   │  │
│   │    └────────────────────────────────────────────────────────────────────────┘   │  │
│   │                                         │                                        │  │
│   │                                         │ Miss                                   │  │
│   │                                         ▼                                        │  │
│   │    ┌────────────────────────────────────────────────────────────────────────┐   │  │
│   │    │                                                                        │   │  │
│   │    │   LAYER 2: WARM CACHE (Application)             TTL: 1 hour - 24 hour │   │  │
│   │    │                                                                        │   │  │
│   │    │   • Product specifications                                             │   │  │
│   │    │   • Competitor data (web)                                              │   │  │
│   │    │   • Frequently asked comparisons                                       │   │  │
│   │    │                                                                        │   │  │
│   │    │   Hit Rate Target: 85%+                                                │   │  │
│   │    │                                                                        │   │  │
│   │    └────────────────────────────────────────────────────────────────────────┘   │  │
│   │                                         │                                        │  │
│   │                                         │ Miss                                   │  │
│   │                                         ▼                                        │  │
│   │    ┌────────────────────────────────────────────────────────────────────────┐   │  │
│   │    │                                                                        │   │  │
│   │    │   LAYER 3: COLD STORAGE (Vector DB)             TTL: 7 days - persist │   │  │
│   │    │                                                                        │   │  │
│   │    │   • Training document embeddings                                       │   │  │
│   │    │   • Policy documents                                                   │   │  │
│   │    │   • Historical data                                                    │   │  │
│   │    │                                                                        │   │  │
│   │    │   Updated: Nightly batch sync                                          │   │  │
│   │    │                                                                        │   │  │
│   │    └────────────────────────────────────────────────────────────────────────┘   │  │
│   │                                                                                  │  │
│   └─────────────────────────────────────────────────────────────────────────────────┘  │
│                                                                                         │
│                                                                                         │
│   ┌─────────────────────────────────────────────────────────────────────────────────┐  │
│   │                              CACHE FLOW                                          │  │
│   │                                                                                  │  │
│   │                                                                                  │  │
│   │    Query: "What's the price of Creta SX?"                                       │  │
│   │                                                                                  │  │
│   │                              │                                                   │  │
│   │                              ▼                                                   │  │
│   │                    ┌─────────────────────┐                                      │  │
│   │                    │ Check Hot Cache     │                                      │  │
│   │                    │ (Price data)        │                                      │  │
│   │                    └──────────┬──────────┘                                      │  │
│   │                               │                                                  │  │
│   │                    ┌──────────┴──────────┐                                      │  │
│   │                    │                     │                                      │  │
│   │                  HIT │                   │ MISS                                  │  │
│   │                    │                     │                                      │  │
│   │                    ▼                     ▼                                      │  │
│   │          ┌──────────────────┐  ┌──────────────────┐                            │  │
│   │          │ Return cached    │  │ Fetch from LMS   │                            │  │
│   │          │ price (< 5ms)    │  │ API              │                            │  │
│   │          └──────────────────┘  └─────────┬────────┘                            │  │
│   │                                          │                                      │  │
│   │                                          ▼                                      │  │
│   │                                ┌──────────────────┐                            │  │
│   │                                │ Store in cache   │                            │  │
│   │                                │ TTL: 1 hour      │                            │  │
│   │                                └─────────┬────────┘                            │  │
│   │                                          │                                      │  │
│   │                                          ▼                                      │  │
│   │                                ┌──────────────────┐                            │  │
│   │                                │ Return fresh     │                            │  │
│   │                                │ price (< 200ms)  │                            │  │
│   │                                └──────────────────┘                            │  │
│   │                                                                                  │  │
│   └─────────────────────────────────────────────────────────────────────────────────┘  │
│                                                                                         │
└─────────────────────────────────────────────────────────────────────────────────────────┘
```

<br/>

---

<br/>

## 6. Session & Memory Flow

How we maintain context across conversations:

<br/>

```
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                                                                                         │
│                           SESSION & MEMORY ARCHITECTURE                                 │
│                                                                                         │
│                                                                                         │
│   ┌─────────────────────────────────────────────────────────────────────────────────┐  │
│   │                                                                                 │  │
│   │   SHORT-TERM MEMORY (Session)                                                   │  │
│   │                                                                                 │  │
│   │   Scope: Current conversation                                                   │  │
│   │   Storage: Redis                                                                │  │
│   │   TTL: Session duration (8 hours)                                               │  │
│   │                                                                                 │  │
│   │                                                                                 │  │
│   │   Session Object:                                                               │  │
│   │   ┌───────────────────────────────────────────────────────────────────────┐    │  │
│   │   │                                                                       │    │  │
│   │   │   {                                                                   │    │  │
│   │   │     "session_id": "abc123",                                           │    │  │
│   │   │     "user_id": "SC_001",                                              │    │  │
│   │   │     "language": "hindi",                                              │    │  │
│   │   │     "context_window": [                                               │    │  │
│   │   │       { "role": "user", "content": "Tell me about Creta" },           │    │  │
│   │   │       { "role": "assistant", "content": "Creta is..." },              │    │  │
│   │   │       { "role": "user", "content": "Compare with Seltos" }            │    │  │
│   │   │     ],                                                                │    │  │
│   │   │     "active_model": "Creta",                                          │    │  │
│   │   │     "comparison_cache": { "Creta_vs_Seltos": {...} }                  │    │  │
│   │   │   }                                                                   │    │  │
│   │   │                                                                       │    │  │
│   │   └───────────────────────────────────────────────────────────────────────┘    │  │
│   │                                                                                 │  │
│   └─────────────────────────────────────────────────────────────────────────────────┘  │
│                                                                                         │
│                                           │                                             │
│                                           │ Persisted on session end                    │
│                                           ▼                                             │
│                                                                                         │
│   ┌─────────────────────────────────────────────────────────────────────────────────┐  │
│   │                                                                                 │  │
│   │   LONG-TERM MEMORY (User Profile)                                               │  │
│   │                                                                                 │  │
│   │   Scope: User lifetime                                                          │  │
│   │   Storage: MongoDB                                                              │  │
│   │   TTL: Persistent                                                               │  │
│   │                                                                                 │  │
│   │                                                                                 │  │
│   │   User Profile:                                                                 │  │
│   │   ┌───────────────────────────────────────────────────────────────────────┐    │  │
│   │   │                                                                       │    │  │
│   │   │   {                                                                   │    │  │
│   │   │     "user_id": "SC_001",                                              │    │  │
│   │   │     "name": "Rahul Sharma",                                           │    │  │
│   │   │     "dealer": "DEL_Connaught",                                        │    │  │
│   │   │     "region": "North",                                                │    │  │
│   │   │                                                                       │    │  │
│   │   │     "preferences": {                                                  │    │  │
│   │   │       "language": "hindi",                                            │    │  │
│   │   │       "response_format": "detailed"                                   │    │  │
│   │   │     },                                                                │    │  │
│   │   │                                                                       │    │  │
│   │   │     "query_patterns": {                                               │    │  │
│   │   │       "most_asked_model": "Creta",                                    │    │  │
│   │   │       "common_comparisons": ["Creta_vs_Seltos", "Venue_vs_Brezza"],   │    │  │
│   │   │       "knowledge_gaps": ["ADAS features", "Finance options"]          │    │  │
│   │   │     },                                                                │    │  │
│   │   │                                                                       │    │  │
│   │   │     "stats": {                                                        │    │  │
│   │   │       "total_sessions": 45,                                           │    │  │
│   │   │       "avg_session_duration": "8 min",                                │    │  │
│   │   │       "gamification_points": 850                                      │    │  │
│   │   │     }                                                                 │    │  │
│   │   │   }                                                                   │    │  │
│   │   │                                                                       │    │  │
│   │   └───────────────────────────────────────────────────────────────────────┘    │  │
│   │                                                                                 │  │
│   └─────────────────────────────────────────────────────────────────────────────────┘  │
│                                                                                         │
│                                                                                         │
│   ┌─────────────────────────────────────────────────────────────────────────────────┐  │
│   │                                                                                 │  │
│   │   PERSONALIZATION FLOW                                                          │  │
│   │                                                                                 │  │
│   │                                                                                 │  │
│   │    New Session                                                                  │  │
│   │         │                                                                       │  │
│   │         ▼                                                                       │  │
│   │    ┌─────────────────┐                                                         │  │
│   │    │ Load user       │                                                         │  │
│   │    │ profile from DB │                                                         │  │
│   │    └────────┬────────┘                                                         │  │
│   │             │                                                                   │  │
│   │             ▼                                                                   │  │
│   │    ┌─────────────────┐                                                         │  │
│   │    │ Pre-set language│                                                         │  │
│   │    │ and preferences │                                                         │  │
│   │    └────────┬────────┘                                                         │  │
│   │             │                                                                   │  │
│   │             ▼                                                                   │  │
│   │    ┌─────────────────┐                                                         │  │
│   │    │ Personalized    │  Example: "Welcome back, Rahul! You were                │  │
│   │    │ greeting        │  asking about Creta vs Seltos yesterday..."             │  │
│   │    └─────────────────┘                                                         │  │
│   │                                                                                 │  │
│   └─────────────────────────────────────────────────────────────────────────────────┘  │
│                                                                                         │
└─────────────────────────────────────────────────────────────────────────────────────────┘
```

<br/>

---

<br/>

## 7. Analytics Data Flow

How usage data flows to dashboards:

<br/>

```
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                                                                                         │
│                           ANALYTICS DATA FLOW                                           │
│                                                                                         │
│                                                                                         │
│   ┌─────────────────────────────────────────────────────────────────────────────────┐  │
│   │   EVENT COLLECTION                                                              │  │
│   │                                                                                 │  │
│   │                                                                                 │  │
│   │   User Interaction                                                              │  │
│   │        │                                                                        │  │
│   │        ├────── Query Event ─────────────────►  Query Log                       │  │
│   │        │       • Query text                    • Timestamp                      │  │
│   │        │       • Intent detected               • User ID                        │  │
│   │        │       • Model mentioned               • Session ID                     │  │
│   │        │                                                                        │  │
│   │        ├────── Session Event ───────────────►  Session Log                     │  │
│   │        │       • Duration                      • Start/End time                 │  │
│   │        │       • Query count                   • User ID                        │  │
│   │        │                                                                        │  │
│   │        └────── Feedback Event ──────────────►  Feedback Log                    │  │
│   │                • Rating (if given)             • Query ID                       │  │
│   │                • Was response helpful?         • Timestamp                      │  │
│   │                                                                                 │  │
│   └─────────────────────────────────────────────────────────────────────────────────┘  │
│                                          │                                             │
│                                          ▼                                             │
│   ┌─────────────────────────────────────────────────────────────────────────────────┐  │
│   │   EVENT PROCESSING                                                              │  │
│   │                                                                                 │  │
│   │                                                                                 │  │
│   │    Raw Events                                                                   │  │
│   │         │                                                                       │  │
│   │         ▼                                                                       │  │
│   │    ┌─────────────────────┐                                                     │  │
│   │    │   Stream Processor  │                                                     │  │
│   │    │                     │                                                     │  │
│   │    │   • Real-time agg   │                                                     │  │
│   │    │   • Enrichment      │                                                     │  │
│   │    │   • Anonymization   │                                                     │  │
│   │    └──────────┬──────────┘                                                     │  │
│   │               │                                                                 │  │
│   │               ▼                                                                 │  │
│   │    ┌─────────────────────┐                                                     │  │
│   │    │   Analytics DB      │                                                     │  │
│   │    │   (PostgreSQL)      │                                                     │  │
│   │    │                     │                                                     │  │
│   │    │   Tables:           │                                                     │  │
│   │    │   • daily_usage     │                                                     │  │
│   │    │   • model_queries   │                                                     │  │
│   │    │   • user_activity   │                                                     │  │
│   │    │   • knowledge_gaps  │                                                     │  │
│   │    └─────────────────────┘                                                     │  │
│   │                                                                                 │  │
│   └─────────────────────────────────────────────────────────────────────────────────┘  │
│                                          │                                             │
│                                          ▼                                             │
│   ┌─────────────────────────────────────────────────────────────────────────────────┐  │
│   │   DASHBOARD DELIVERY                                                            │  │
│   │                                                                                 │  │
│   │                                                                                 │  │
│   │         ┌──────────────────────────────────────────────────────────────┐       │  │
│   │         │                                                              │       │  │
│   │         │   HO DASHBOARD                                               │       │  │
│   │         │                                                              │       │  │
│   │         │   ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐        │       │  │
│   │         │   │ 2,450   │  │  8 min  │  │  89%    │  │ Creta   │        │       │  │
│   │         │   │Sessions │  │ Avg Time│  │ Active  │  │ #1 Ask  │        │       │  │
│   │         │   └─────────┘  └─────────┘  └─────────┘  └─────────┘        │       │  │
│   │         │                                                              │       │  │
│   │         │   [Query Trends]  [Model Popularity]  [Knowledge Gaps]       │       │  │
│   │         │                                                              │       │  │
│   │         └──────────────────────────────────────────────────────────────┘       │  │
│   │                                                                                 │  │
│   │         ┌──────────────────────────────────────────────────────────────┐       │  │
│   │         │                                                              │       │  │
│   │         │   RO DASHBOARD                                               │       │  │
│   │         │                                                              │       │  │
│   │         │   ┌─────────┐  ┌─────────┐  ┌─────────────────────┐         │       │  │
│   │         │   │ Dealer  │  │ SC      │  │                     │         │       │  │
│   │         │   │ Usage   │  │ Ranking │  │  Training Required  │         │       │  │
│   │         │   └─────────┘  └─────────┘  │  • 5 SCs: ADAS      │         │       │  │
│   │         │                             │  • 3 SCs: Finance   │         │       │  │
│   │         │                             └─────────────────────┘         │       │  │
│   │         │                                                              │       │  │
│   │         └──────────────────────────────────────────────────────────────┘       │  │
│   │                                                                                 │  │
│   └─────────────────────────────────────────────────────────────────────────────────┘  │
│                                                                                         │
└─────────────────────────────────────────────────────────────────────────────────────────┘
```

<br/>

---

<br/>

## 8. Summary: Data Flow Matrix

<br/>

| Flow | Source | Destination | Trigger | Latency |
|------|--------|-------------|---------|---------|
| User Query | Widget | Orchestrator | Real-time | < 100ms |
| LMS Data | Hyundai LMS | Vector Store | Nightly batch | N/A |
| Live Pricing | LMS API | Response | Per query | < 200ms |
| Competitor Data | Web Search | Cache | Per query | < 500ms |
| User Profile | MongoDB | Session | Session start | < 50ms |
| Analytics | Events | Dashboard | Stream | < 1 min |
| Webhooks | Hyundai CMS | Vector Store | On change | < 30s |

<br/>

---

<br/>

**Prepared by:** Maigic.AI  
**Contact:** [Your Contact Information]  


*Confidential - For Hyundai Motor India Only*
